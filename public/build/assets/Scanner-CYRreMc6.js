import{d as S,r as y,b as r,e as n,f as e,u as a,h as N,w as c,l as P,y as k,g as u,o as l,x as b,t as o,G as T,J as R}from"./app-dkNPWVuj.js";import{s as _,a as h}from"./index-p3p8LMzb.js";import{s as B}from"./index-C-x3wNAr.js";import{s as E}from"./index-zELwqlq_.js";import{s as w}from"./index-Dcr1yg-Y.js";import"./index-DwuUCPtR.js";import"./index-chFnNFZo.js";import"./index-BsCRQRu3.js";const j={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},$={class:"bg-white shadow dark:bg-gray-800"},A={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},D={class:"flex items-center justify-between"},F={class:"mx-auto max-w-4xl px-4 py-8 sm:px-6 lg:px-8"},G={class:"space-y-6"},K={class:"flex gap-3"},O={key:0,class:"mt-6"},Q={class:"space-y-2"},J={class:"flex items-center gap-2"},L={class:"text-lg font-semibold"},U={key:0,class:"ml-9 space-y-1 text-sm"},q={class:"flex items-center gap-2"},X={class:"text-lg font-semibold"},z={key:0,class:"py-8 text-center text-gray-500"},H={key:1,class:"space-y-4"},I={class:"font-semibold text-gray-900 dark:text-white"},M={class:"text-sm text-gray-600 dark:text-gray-400"},W={class:"text-sm text-gray-600 dark:text-gray-400"},ie=S({__name:"Scanner",props:{ceremonies:{},entryPoints:{}},setup(p){const V=p,d=y(""),x=y(V.entryPoints[0]),s=y(null),v=y(!1),m=y(!1),f=async()=>{if(d.value.trim()){v.value=!0,m.value=!1;try{const t=await(await fetch("/security/verify-by-code",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({ticket_code:d.value,entry_point:x.value,device_info:navigator.userAgent})})).json();s.value=t,m.value=!0,d.value="",t.success&&setTimeout(()=>{m.value=!1},5e3)}catch{s.value={success:!1,message:"Failed to verify ticket. Please try again."},m.value=!0}finally{v.value=!1}}},C=g=>{g.key==="Enter"&&f()};return(g,t)=>(l(),r("div",j,[n(a(N),{title:"QR Scanner"}),e("div",$,[e("div",A,[e("div",D,[t[2]||(t[2]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"}," QR Code Scanner "),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Verify ticket entry ")],-1)),n(a(P),{href:"/security/dashboard"},{default:c(()=>[n(a(_),{label:"Back to Dashboard",severity:"secondary",outlined:""})]),_:1})])])]),e("div",F,[n(a(h),{class:"mb-6 shadow-lg"},{content:c(()=>[e("div",G,[e("div",null,[t[3]||(t[3]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Entry Point ",-1)),n(a(E),{modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=i=>x.value=i),options:p.entryPoints,class:"w-full",placeholder:"Select entry point"},null,8,["modelValue","options"])]),e("div",null,[t[4]||(t[4]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Ticket Code ",-1)),e("div",K,[n(a(B),{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=i=>d.value=i),class:"flex-1",placeholder:"Enter or scan ticket code",onKeypress:C,disabled:v.value},null,8,["modelValue","disabled"]),n(a(_),{label:"Verify",icon:"pi pi-check",onClick:f,loading:v.value,disabled:!d.value.trim()},null,8,["loading","disabled"])]),t[5]||(t[5]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"pi pi-info-circle"}),u(" Scan QR code with a barcode scanner or enter the ticket code manually ")],-1))]),m.value&&s.value?(l(),r("div",O,[s.value.success?(l(),b(a(w),{key:0,severity:"success",closable:!1},{default:c(()=>[e("div",Q,[e("div",J,[t[6]||(t[6]=e("i",{class:"pi pi-check-circle text-2xl"},null,-1)),e("span",L,o(s.value.message),1)]),s.value.ticket?(l(),r("div",U,[e("p",null,[t[7]||(t[7]=e("strong",null,"Graduate:",-1)),u(" "+o(s.value.ticket.graduate?.student_name),1)]),e("p",null,[t[8]||(t[8]=e("strong",null,"Ceremony:",-1)),u(" "+o(s.value.ticket.graduate?.ceremony?.name),1)]),e("p",null,[t[9]||(t[9]=e("strong",null,"Guest:",-1)),u(" "+o(s.value.ticket.guest_name||"Not assigned"),1)]),e("p",null,[t[10]||(t[10]=e("strong",null,"Ticket Code:",-1)),u(" "+o(s.value.ticket.ticket_code),1)])])):k("",!0)])]),_:1})):(l(),b(a(w),{key:1,severity:"error",closable:!1},{default:c(()=>[e("div",q,[t[11]||(t[11]=e("i",{class:"pi pi-times-circle text-2xl"},null,-1)),e("span",X,o(s.value.message),1)])]),_:1}))])):k("",!0)])]),_:1}),n(a(h),{class:"shadow-sm"},{title:c(()=>[...t[12]||(t[12]=[u("Active Ceremonies",-1)])]),content:c(()=>[p.ceremonies.length===0?(l(),r("div",z," No active ceremonies ")):(l(),r("div",H,[(l(!0),r(T,null,R(p.ceremonies,i=>(l(),r("div",{key:i.id,class:"flex items-center justify-between rounded-lg border border-gray-200 p-4 dark:border-gray-700"},[e("div",null,[e("h3",I,o(i.name),1),e("p",M,o(new Date(i.ceremony_date).toLocaleString()),1),e("p",W,o(i.venue),1)])]))),128))]))]),_:1})])]))}});export{ie as default};
