import{d as S,r as p,c as r,a as i,b as e,u as a,h as N,w as c,l as P,f as k,g as u,o as l,e as b,t as o,F as T,j as R}from"./app-BDhL6A7S.js";import{s as _,a as h}from"./index-506mRMkX.js";import{s as j}from"./index-CCHrQ35O.js";import{s as B}from"./index-CM_FHf5l.js";import{s as w}from"./index-BL5C0QgH.js";var D={name:"Dropdown",extends:B,mounted:function(){console.warn("Deprecated since v4. Use Select component instead.")}};const E={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},$={class:"bg-white shadow dark:bg-gray-800"},F={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},A={class:"flex items-center justify-between"},K={class:"mx-auto max-w-4xl px-4 py-8 sm:px-6 lg:px-8"},O={class:"space-y-6"},Q={class:"flex gap-3"},U={key:0,class:"mt-6"},G={class:"space-y-2"},L={class:"flex items-center gap-2"},q={class:"text-lg font-semibold"},J={key:0,class:"ml-9 space-y-1 text-sm"},X={class:"flex items-center gap-2"},z={class:"text-lg font-semibold"},H={key:0,class:"py-8 text-center text-gray-500"},I={key:1,class:"space-y-4"},M={class:"font-semibold text-gray-900 dark:text-white"},W={class:"text-sm text-gray-600 dark:text-gray-400"},Y={class:"text-sm text-gray-600 dark:text-gray-400"},le=S({__name:"Scanner",props:{ceremonies:{},entryPoints:{}},setup(m){const V=m,d=p(""),g=p(V.entryPoints[0]),s=p(null),v=p(!1),y=p(!1),x=async()=>{if(d.value.trim()){v.value=!0,y.value=!1;try{const t=await(await fetch("/security/verify-by-code",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({ticket_code:d.value,entry_point:g.value,device_info:navigator.userAgent})})).json();s.value=t,y.value=!0,d.value="",t.success&&setTimeout(()=>{y.value=!1},5e3)}catch{s.value={success:!1,message:"Failed to verify ticket. Please try again."},y.value=!0}finally{v.value=!1}}},C=f=>{f.key==="Enter"&&x()};return(f,t)=>(l(),r("div",E,[i(a(N),{title:"QR Scanner"}),e("div",$,[e("div",F,[e("div",A,[t[2]||(t[2]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"}," QR Code Scanner "),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Verify ticket entry ")],-1)),i(a(P),{href:"/security/dashboard"},{default:c(()=>[i(a(_),{label:"Back to Dashboard",severity:"secondary",outlined:""})]),_:1})])])]),e("div",K,[i(a(h),{class:"mb-6 shadow-lg"},{content:c(()=>[e("div",O,[e("div",null,[t[3]||(t[3]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Entry Point ",-1)),i(a(D),{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=n=>g.value=n),options:m.entryPoints,class:"w-full",placeholder:"Select entry point"},null,8,["modelValue","options"])]),e("div",null,[t[4]||(t[4]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Ticket Code ",-1)),e("div",Q,[i(a(j),{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=n=>d.value=n),class:"flex-1",placeholder:"Enter or scan ticket code",onKeypress:C,disabled:v.value},null,8,["modelValue","disabled"]),i(a(_),{label:"Verify",icon:"pi pi-check",onClick:x,loading:v.value,disabled:!d.value.trim()},null,8,["loading","disabled"])]),t[5]||(t[5]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"pi pi-info-circle"}),u(" Scan QR code with a barcode scanner or enter the ticket code manually ")],-1))]),y.value&&s.value?(l(),r("div",U,[s.value.success?(l(),b(a(w),{key:0,severity:"success",closable:!1},{default:c(()=>[e("div",G,[e("div",L,[t[6]||(t[6]=e("i",{class:"pi pi-check-circle text-2xl"},null,-1)),e("span",q,o(s.value.message),1)]),s.value.ticket?(l(),r("div",J,[e("p",null,[t[7]||(t[7]=e("strong",null,"Graduate:",-1)),u(" "+o(s.value.ticket.graduate?.student_name),1)]),e("p",null,[t[8]||(t[8]=e("strong",null,"Ceremony:",-1)),u(" "+o(s.value.ticket.graduate?.ceremony?.name),1)]),e("p",null,[t[9]||(t[9]=e("strong",null,"Guest:",-1)),u(" "+o(s.value.ticket.guest_name||"Not assigned"),1)]),e("p",null,[t[10]||(t[10]=e("strong",null,"Ticket Code:",-1)),u(" "+o(s.value.ticket.ticket_code),1)])])):k("",!0)])]),_:1})):(l(),b(a(w),{key:1,severity:"error",closable:!1},{default:c(()=>[e("div",X,[t[11]||(t[11]=e("i",{class:"pi pi-times-circle text-2xl"},null,-1)),e("span",z,o(s.value.message),1)])]),_:1}))])):k("",!0)])]),_:1}),i(a(h),{class:"shadow-sm"},{title:c(()=>[...t[12]||(t[12]=[u("Active Ceremonies",-1)])]),content:c(()=>[m.ceremonies.length===0?(l(),r("div",H," No active ceremonies ")):(l(),r("div",I,[(l(!0),r(T,null,R(m.ceremonies,n=>(l(),r("div",{key:n.id,class:"flex items-center justify-between rounded-lg border border-gray-200 p-4 dark:border-gray-700"},[e("div",null,[e("h3",M,o(n.name),1),e("p",W,o(new Date(n.ceremony_date).toLocaleString()),1),e("p",Y,o(n.venue),1)])]))),128))]))]),_:1})])]))}});export{le as default};
